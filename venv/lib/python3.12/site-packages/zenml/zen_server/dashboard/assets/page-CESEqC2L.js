import{j as e,r as n}from"./@radix-Cdvw4jJ8.js";import{f as p,i as f,F as y,j,as as g,au as v,V as C,B as d,ap as u,aQ as x,aO as N,g as w,ac as E,ad as b,ae as F,af as k,S as V}from"./index-BgEfQ3_G.js";import{S as _}from"./chevron-down-jbbQh82s.js";import{I as H}from"./Infobox-CSBRrM6r.js";import{c as S,b as P}from"./@tanstack-5gTMR7G2.js";import{a as B}from"./@react-router-DeDfXbUF.js";import"./@reactflow-B_iCtR7X.js";import"./info-QkbQz4QU.js";async function D({connectorId:t}){const s=f(j.serviceConnectors.verifyExisting(t)),a=await p(s,{method:"PUT",headers:{"Content-Type":"application/json"}});if(!a.ok){const r=await a.json().then(l=>Array.isArray(l.detail)?l.detail[1]:l.detail).catch(()=>"Failed to verify connector");throw new y({status:a.status,statusText:a.statusText,message:r})}return a.json()}function A(t){return S({...t,mutationFn:async({connectorId:s})=>D({connectorId:s})})}const M="/assets/connectivity-4UKGMYnr.webp";function R({open:t,isLoading:s,isError:a,onClose:r,onSuccess:l,data:c}){const i=!!(c!=null&&c.error),o=(c==null?void 0:c.error)??void 0;return e.jsx(g,{open:t,children:e.jsx(v,{onPointerDownOutside:m=>s?m.preventDefault():r==null?void 0:r(),onEscapeKeyDown:m=>s?m.preventDefault():r==null?void 0:r(),className:"max-w-[540px] p-8",children:e.jsxs("div",{className:"flex w-full flex-col items-center justify-center space-y-5",children:[s&&!c&&e.jsx(T,{onClose:r}),!s&&!a&&!i&&e.jsx(O,{onSuccess:l}),!s&&(a||i)&&e.jsx(Z,{error:o,onClose:r})]})})})}function T({onClose:t}){return e.jsxs(e.Fragment,{children:[e.jsx(C,{}),e.jsxs("div",{className:"space-y-2 text-center",children:[e.jsx("p",{className:"text-display-xs font-semibold",children:"Verifying your service connector"}),e.jsxs("p",{className:"text-text-lg text-theme-text-secondary",children:["Please wait while we check your connection ",e.jsx("br",{}),"This may take up to a minute."]})]}),e.jsx(d,{size:"md",emphasis:"subtle",onClick:t,intent:"secondary",className:"mt-4",children:"Cancel"})]})}function O({onSuccess:t}){return e.jsxs(e.Fragment,{children:[e.jsx(u,{width:180,height:180,className:"fill-theme-text-success"}),e.jsxs("div",{className:"space-y-2 text-center",children:[e.jsx("p",{className:"text-display-xs font-semibold",children:"Connection verified successfully!"}),e.jsx("p",{className:"text-text-lg text-theme-text-secondary",children:"Ready to show your available resources"})]}),e.jsx(d,{size:"md",onClick:t,className:"mt-4",children:"Display Resources"})]})}function Z({onClose:t,error:s}){return e.jsxs(e.Fragment,{children:[e.jsx("img",{src:M,alt:"Connectivity",width:180,height:180}),e.jsxs("div",{className:"space-y-2 text-center",children:[e.jsx("p",{className:"text-display-xs font-semibold",children:"We couldn't verify your connection"}),s&&e.jsx("p",{className:"max-h-[250px] overflow-auto rounded-md border border-theme-border-moderate bg-theme-surface-secondary p-1 text-left font-mono",children:s}),e.jsx("p",{className:"text-text-lg text-theme-text-secondary",children:"Please try again to list your resources"})]}),e.jsx(d,{size:"md",emphasis:"subtle",onClick:t,intent:"secondary",className:"mt-4",children:"Close"})]})}function h({children:t}){const{setResources:s}=x(),{connectorId:a}=B(),r=P({...N.serviceConnectorDetail(a),throwOnError:!0}),[l,c]=n.useState(!1),i=A();if(r.isPending)return e.jsx(w,{className:"h-7 w-[150px]"});if(r.isError)return null;const o=()=>{c(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(R,{data:i.data,open:l,isLoading:i.isPending,isError:i.isError,onClose:o,onSuccess:()=>{i.data&&(s(i.data),c(!1))}}),e.jsxs(d,{disabled:i.isPending&&l,onClick:()=>{c(!0),i.mutate({connectorId:a})},className:"gap-1",size:"md",children:[e.jsx(u,{width:24,height:24,className:"size-5 shrink-0 fill-white"}),t]})]})}function z(){var a;const{resources:t}=x();if(!t)return null;const s=t.connector_type;return!s||typeof s=="string"?null:e.jsxs("div",{className:"space-y-5",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(h,{children:e.jsx("span",{children:"Reverify now"})})}),(a=t.resources)==null?void 0:a.map(r=>{var l,c;return e.jsx(I,{title:(l=s.resource_types.find(i=>i.resource_type===r.resource_type))==null?void 0:l.name,logoUrl:((c=s.resource_types.find(i=>i.resource_type===r.resource_type))==null?void 0:c.logo_url)??void 0,resource:r},r.resource_type)})]})}function I({resource:t,title:s,logoUrl:a}){const[r,l]=n.useState(!0),c=t.error,i=t.resource_ids??[];return e.jsxs(E,{open:r,onOpenChange:l,children:[e.jsx(b,{className:"flex items-center gap-[10px]",children:e.jsxs(F,{className:"flex w-full items-center gap-[10px] text-text-lg",children:[e.jsx(_,{className:` ${r?"":"-rotate-90"} h-5 w-5 rounded-md fill-neutral-500 transition-transform duration-200 hover:bg-neutral-200`}),s||t.resource_type]})}),e.jsx(k,{className:"space-y-5 border-t border-theme-border-moderate bg-theme-surface-primary",children:c?e.jsx("div",{className:"p-5",children:e.jsx(H,{intent:"error",children:c})}):e.jsx("ul",{className:"divide-y divide-theme-border-moderate",children:i.map(o=>e.jsxs("li",{className:"flex items-center space-x-2 py-3 pl-8",children:[!!a&&e.jsx("img",{width:24,height:24,src:a,alt:s,className:"size-5 shrink-0"}),e.jsx("span",{children:o})]},o))})})]})}const Q=t=>n.createElement("svg",{width:182,height:104,viewBox:"0 0 182 104",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},n.createElement("path",{d:"M35 12C35 7.58172 38.5817 4 43 4H147C151.418 4 155 7.58172 155 12V96C155 100.418 151.418 104 147 104H43C38.5817 104 35 100.418 35 96V12Z",fill:"#F1EBFE"}),n.createElement("path",{d:"M1 56H181",stroke:"#7A3EF4",strokeLinecap:"round"}),n.createElement("path",{d:"M16 61H166",stroke:"#7A3EF4",strokeLinecap:"round"}),n.createElement("g",{clipPath:"url(#clip0_8218_459)"},n.createElement("path",{d:"M31 8C31 3.58172 34.5817 0 39 0H143C147.418 0 151 3.58172 151 8V92C151 96.4183 147.418 100 143 100H39C34.5817 100 31 96.4183 31 92V8Z",fill:"white"}),n.createElement("mask",{id:"path-6-inside-1_8218_459",fill:"white"},n.createElement("path",{d:"M31 0H151V12H31V0Z"})),n.createElement("path",{d:"M31 0H151V12H31V0Z",fill:"#FBF9FF"}),n.createElement("path",{d:"M151 11H31V13H151V11Z",fill:"#7A3EF4",mask:"url(#path-6-inside-1_8218_459)"}),n.createElement("circle",{cx:41,cy:6,r:2,fill:"#AF8BF8"}),n.createElement("circle",{cx:47,cy:6,r:2,fill:"#AF8BF8"}),n.createElement("circle",{cx:53,cy:6,r:2,fill:"#AF8BF8"})),n.createElement("path",{d:"M31.5 8C31.5 3.85786 34.8579 0.5 39 0.5H143C147.142 0.5 150.5 3.85786 150.5 8V92C150.5 96.1421 147.142 99.5 143 99.5H39C34.8579 99.5 31.5 96.1421 31.5 92V8Z",stroke:"#7A3EF4"}),n.createElement("defs",null,n.createElement("clipPath",{id:"clip0_8218_459"},n.createElement("path",{d:"M31 8C31 3.58172 34.5817 0 39 0H143C147.418 0 151 3.58172 151 8V92C151 96.4183 147.418 100 143 100H39C34.5817 100 31 96.4183 31 92V8Z",fill:"white"}))));function K({icon:t}){return e.jsxs("div",{className:"relative",children:[e.jsx(Q,{}),e.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 rounded-rounded bg-primary-25 p-3",children:t})]})}function L(){return e.jsx("div",{className:"p-9",children:e.jsxs("div",{className:"flex flex-col items-center space-y-5",children:[e.jsx(K,{icon:e.jsx(V,{className:"h-[36px] w-[36px] fill-primary-400"})}),e.jsxs("div",{className:"space-y-2 text-center",children:[e.jsx("p",{className:"text-display-xs font-semibold",children:"Please verify your service connector"}),e.jsxs("p",{className:"text-text-lg text-theme-text-secondary",children:["We'll check your connection and load available resources.",e.jsx("br",{}),"This may take up to a minute."]})]}),e.jsx(h,{children:e.jsx("span",{children:"Verify now"})})]})})}function ee(){const{resources:t}=x();return t===null?e.jsx(L,{}):e.jsx(z,{})}export{ee as default};
