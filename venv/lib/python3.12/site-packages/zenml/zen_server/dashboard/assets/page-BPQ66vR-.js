import{r as l,j as e}from"./@radix-Cdvw4jJ8.js";import{a as p,u as D,S as v,E as S}from"./SecretTooltip-B5u1UsQ9.js";import{b as f,h as b}from"./@tanstack-5gTMR7G2.js";import{aC as C,b3 as N,aD as w,I as j,b4 as E,aF as k,B as h,aB as T,b5 as A,D as K,l as V,m as B,p as O,g as F,as as L,at as z,x as I,y as Q,b6 as R,r as q,b as P,v as H}from"./index-BgEfQ3_G.js";import{S as M}from"./eye-CbVlAYty.js";import{S as _}from"./key-icon-C07HKw8z.js";import{S as $}from"./trash-DP6Tpp_E.js";import{A as U}from"./AlertDialogDropdownItem-DsOmO1FH.js";import{a as G}from"./@react-router-DeDfXbUF.js";import"./plus-Cl0_rCVF.js";import"./zod-XdS2h1ws.js";import"./index.esm-DhJo3mA6.js";import"./CodeSnippet-Ctplhzdc.js";import"./info-QkbQz4QU.js";import"./@reactflow-B_iCtR7X.js";function J({secretId:t,keyName:s}){const{data:a,isLoading:r,isError:u}=f({...p.secretDetail(t)}),i=b(),{mutate:c}=D({onError(d){T(d)&&A({status:"error",emphasis:"subtle",description:d.message,rounded:!0})},onSuccess(){i.invalidateQueries({queryKey:["secrets"]}),i.invalidateQueries({queryKey:["secretDetail",t]})}}),[n,m]=l.useState(""),x=()=>{var d;if(a){const g={...(d=a.body)==null?void 0:d.values};delete g[s];const y={name:a.name,values:g};c({id:t,body:y})}};function o(d){m(d.target.value)}return r?e.jsx("div",{children:"Loading..."}):u?e.jsx("div",{children:"Error loading secret details"}):e.jsxs(C,{children:[e.jsx(N,{children:e.jsx(w,{children:"Delete Key"})}),e.jsxs("div",{className:"gap-5 p-5",children:[e.jsx("p",{className:"text-text-md text-theme-text-secondary",children:"Are you sure you want to delete this key?"}),e.jsx("p",{className:"text-text-md text-theme-text-secondary",children:"This action cannot be undone."}),e.jsx("h3",{className:"font-inter text-sm mb-1 mt-4 text-left font-medium leading-5",children:"Please type DELETE to confirm"}),e.jsx(j,{name:"key",onChange:o,className:"w-full",required:!0,value:n})]}),e.jsxs(E,{className:"gap-[10px]",children:[e.jsx(k,{asChild:!0,children:e.jsx(h,{size:"sm",intent:"secondary",children:"Cancel"})}),e.jsx(h,{intent:"danger",type:"button",onClick:x,disabled:n!=="DELETE",children:"Delete"})]})]})}function W({secretId:t,keyName:s}){const[a,r]=l.useState(!1),[u,i]=l.useState(!1),c=l.useRef(null),n=l.useRef(null);function m(){n.current=c.current}function x(o){if(o===!1){r(!1),setTimeout(()=>{i(o)},200);return}i(o)}return e.jsxs(K,{onOpenChange:r,open:a,children:[e.jsx(V,{ref:c,children:e.jsx(B,{className:"h-4 w-4 fill-theme-text-tertiary"})}),e.jsx(O,{hidden:u,onCloseAutoFocus:o=>{n.current&&(n.current.focus(),n.current=null,o.preventDefault())},align:"end",sideOffset:7,children:e.jsx(U,{onSelect:m,onOpenChange:x,triggerChildren:"Delete ",icon:e.jsx($,{}),children:e.jsx(J,{secretId:t,keyName:s})})})]})}const X=({value:t})=>{const[s,a]=l.useState(!1),r=typeof t=="string"?t:"",u="â€¢".repeat(r.length);return e.jsxs("div",{className:"flex  items-center gap-2 space-x-2",children:[e.jsx(M,{onClick:()=>a(!s),className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{children:s?r:u})]})};function Y(t,s){return[{id:"key",header:"Key",accessorKey:"key",cell:({row:a})=>{const r=`from zenml.client import Client
secret = Client().get_secret("${s}")
	  
# 'secret.secret_values' will contain a dictionary with all key-value pairs within your secret.
secret.secret_values["${a.original.key}"]
	  `;return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(_,{className:"h-5 w-5 flex-shrink-0 fill-primary-400"}),e.jsx("div",{className:"flex flex-col",children:e.jsx("div",{className:"flex items-center space-x-1",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"text-text-md font-semibold text-theme-text-primary",children:a.original.key}),e.jsx(v,{code:r})]})})})]})}},{id:"value",header:"Value",accessorKey:"value",cell:({row:a})=>e.jsx(X,{value:a.getValue("value")})},{id:"actions",header:"",cell:({row:a})=>e.jsx(W,{secretId:t,keyName:a.original.key})}]}function Z({secretId:t}){var c;const[s,a]=l.useState(""),r=f({...p.secretDetail(t)});if(r.isPending)return e.jsx(F,{className:"h-[200px] w-full"});if(r.isError)return e.jsx("div",{children:r.error.message});const i=Object.entries(((c=r.data.body)==null?void 0:c.values)||{}).map(([n,m])=>({key:n,value:m})).filter(n=>n.key.toLowerCase().includes(s.toLowerCase()));return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4 flex flex-wrap items-center justify-between gap-2",children:[e.jsx(j,{type:"text",placeholder:"Search Keys...",value:s,onChange:n=>a(n.target.value),inputSize:"md"}),e.jsxs(L,{children:[e.jsx(z,{asChild:!0,children:e.jsx(h,{size:"sm",intent:"primary",children:"Edit Keys"})}),e.jsx(S,{secretId:t,isSecretNameEditable:!1,dialogTitle:"Edit keys"})]})]}),e.jsx("div",{className:"w-full",children:e.jsx(I,{columns:Y(t,r.data.name),data:i})})]})}function ee(t){const{setBreadcrumbs:s}=Q();l.useEffect(()=>{t&&s([...R,{label:t.name,href:q.settings.secrets.detail(t.id)}])},[t,s])}function fe(){const{secretId:t}=G(),{data:s}=f({...p.secretDetail(t||"")});return ee(s),e.jsx(e.Fragment,{children:e.jsxs(P,{className:"space-y-5 p-5",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-text-xl font-semibold",children:s==null?void 0:s.name}),e.jsxs("div",{className:"group/copybutton flex items-center space-x-1",children:[e.jsx("div",{className:"text-theme-text-secondary",children:t==null?void 0:t.slice(0,8)}),e.jsx(H,{copyText:t})]})]}),e.jsx(Z,{secretId:t||""})]})})}export{fe as default};
